# $Id: pixelMatchElectronSequence.cff,v 1.5 2006/10/27 15:04:03 uberthon Exp $
# create a sequence with all required modules and sources needed to make
# pixel based electrons
# NB: it assumes that ECAL clusters (hybrid) are in the event
#
#

############ initialize magnetic field #########################
include "MagneticField/Engine/data/volumeBasedMagneticField.cfi"

############### initialize geometry #####################
include "Geometry/CMSCommonData/data/cmsIdealGeometryXML.cfi"
include "Geometry/TrackerGeometryBuilder/data/trackerGeometry.cfi"
include "Geometry/TrackerNumberingBuilder/data/trackerNumberingGeometry.cfi"
include "RecoTracker/GeometryESProducer/data/TrackerRecoGeometryESProducer.cfi"

### ESProducers needed for tracking
include "RecoTracker/TransientTrackingRecHit/data/TransientTrackingRecHitBuilder.cfi"
include "TrackingTools/KalmanUpdators/data/KFUpdatorESProducer.cfi"
include "TrackingTools/TrackFitters/data/KFTrajectoryFitterESProducer.cfi"
include "TrackingTools/TrackFitters/data/KFTrajectorySmootherESProducer.cfi"
include "TrackingTools/TrackFitters/data/KFFittingSmootherESProducer.cfi" 
include "TrackingTools/MaterialEffects/data/MaterialPropagator.cfi"
include "TrackingTools/MaterialEffects/data/OppositeMaterialPropagator.cfi"
include "RecoLocalTracker/SiPixelRecHits/data/PixelCPEParmError.cfi"
include "RecoLocalTracker/SiStripRecHitConverter/data/StripCPEfromTrackAngle.cfi"
include "RecoLocalTracker/SiStripRecHitConverter/data/SiStripRecHitMatcher.cfi"
include "RecoEgamma/EgammaElectronProducers/data/CkfTrajectoryBuilderWithSeedAssocESProducer.cff"

# modules to make seeds, tracks and electrons
include "RecoEgamma/EgammaElectronProducers/data/egammaChi2MeasurementEstimatorESProducer.cfi"
include "RecoEgamma/EgammaElectronProducers/data/electronPixelSeeds.cfi"
include "RecoEgamma/EgammaElectronProducers/data/pixelMatchElectrons.cff"
# CKFTrackCandidateMaker
include "RecoEgamma/EgammaElectronProducers/data/CkfTrackCandidatesWithSeedAssoc.cff"
module ckfTrackCandidatesBarrel = ckfTrackCandidates from "RecoEgamma/EgammaElectronProducers/data/CkfTrackCandidatesWithSeedAssoc.cfi"
#replace ckfTrackCandidatesBarrel.TrajectoryBuilder = "CkfTrajectoryBuilderWithSeedAssoc"
replace ckfTrackCandidatesBarrel.SeedProducer ="electronPixelSeeds"
replace ckfTrackCandidatesBarrel.SeedLabel ="correctedHybridSuperClusters"

module ckfTrackCandidatesEndcap = ckfTrackCandidates from "RecoEgamma/EgammaElectronProducers/data/CkfTrackCandidatesWithSeedAssoc.cfi"
#replace ckfTrackCandidatesEndcap.TrajectoryBuilder = "CkfTrajectoryBuilderWithSeedAssoc"
replace ckfTrackCandidatesEndcap.SeedProducer ="electronPixelSeeds"
replace ckfTrackCandidatesEndcap.SeedLabel ="correctedIslandEndcapSuperClusters"

# CTF track fit with material, version using Seed Association
include "RecoEgamma/EgammaElectronProducers/data/CTFFinalFitWithMaterialWithSeedAssoc.cff"
module ctfWithMaterialTracksBarrel = ctfWithMaterialTracks from "RecoEgamma/EgammaElectronProducers/data/CTFFinalFitWithMaterialWithSeedAssoc.cfi"
replace ctfWithMaterialTracksBarrel.src = "ckfTrackCandidatesBarrel"
module ctfWithMaterialTracksEndcap = ctfWithMaterialTracks from "RecoEgamma/EgammaElectronProducers/data/CTFFinalFitWithMaterialWithSeedAssoc.cfi"
replace ctfWithMaterialTracksEndcap.src = "ckfTrackCandidatesEndcap"

sequence pixelMatchElectronSequence = {
                                        electronPixelSeeds,
                                        ckfTrackCandidatesBarrel, 
                                        ckfTrackCandidatesEndcap, 
                                        ctfWithMaterialTracksBarrel,
                                        ctfWithMaterialTracksEndcap,
                                        pixelMatchElectrons
                                      }
